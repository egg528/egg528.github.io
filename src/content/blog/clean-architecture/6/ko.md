---
title: "[만들면서 배우는 클린 아키텍처] 6장: 영속성 어댑터 구현하기"
description: "영속성 어댑터의 의존성 역전과 책임, 포트 인터페이스 설계와 트랜잭션 처리 방법에 대해 알아봅니다."
date: "2023-03-16"
draft: false
---

## 영속성 어댑터 구현하기

### 1. 의존성 역전
![IOC](./diagram-1.webp)
- 영속성 어뎁터는 주도되는(Out) 포트이다.
- Service 계층은 더이상 영속성 계층을 의존하지 않는다.
- 포트의 계약을 만족하는 한 코어에 영향을 미치지 않으면서 영속성 코드를 마음껏 수정할 수 있게 된다.

### 2. 영속성 어댑터의 책임
```
1. 입력을 받는다
2. 입력을 데이터베이스 포맷으로 매핑한다
3. 입력을 데이터베이스로 보낸다
4. 데이터베이스 출력을 애플리케이션 포맷으로 매핑한다
5. 출력을 반환한다
```
- 현 구조에서는 입력 모델을 DB 모델로 변환해야 하는데, 이 과정이 불필요하다고 느낀다면 매핑하지 않는 전략을 고민해볼 필요가 있다 (8장)
- 중요한 점은 입/출력 모델이 영속성 계층에 없고 Core에 존재하기에 Core는 영속성 계층의 기술 변화에 영향을 받지 않는다.

### 3. 포트 인터페이스/영속성 어댑